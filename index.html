<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Operations</title>
    <script>
        const url = google.script.run.withSuccessHandler(renderTable);

        // Load dữ liệu
        function loadData() {
            fetchScript('getData', {}).then(renderTable);
        }

        // Thêm mới
        function addData() {
            const name = document.getElementById('name').value;
            const amount = document.getElementById('amount').value;
            const category = document.getElementById('category').value;

            fetchScript('addData', { name, amount, category }).then(loadData);
        }

        // Sửa dữ liệu
        function editData(id) {
            const name = prompt('Enter new name:');
            const amount = prompt('Enter new amount:');
            const category = prompt('Enter new category:');
            fetchScript('editData', { id, name, amount, category }).then(loadData);
        }

        // Xóa dữ liệu
        function deleteData(id) {
            if (confirm('Are you sure to delete this record?')) {
                fetchScript('deleteData', { id }).then(loadData);
            }
        }

        // Gửi yêu cầu
        async function fetchScript(action, data) {
            const response = await fetch('', {
                method: 'POST',
                body: JSON.stringify({ action, data }),
            });
            return await response.json();
        }

        // Render bảng
        function renderTable(data) {
            const table = document.getElementById('data-table');
            table.innerHTML = data.data.map(row => `
                <tr>
                    <td>${row[0]}</td>
                    <td>${row[1]}</td>
                    <td>${row[2]}</td>
                    <td>${row[3]}</td>
                    <td>
                        <button onclick="editData(${row[0]})">Edit</button>
                        <button onclick="deleteData(${row[0]})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</head>
<body>
    <h1>CRUD Operations</h1>
    <table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Amount</th>
                <th>Category</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="data-table"></tbody>
    </table>

    <h2>Add New Record</h2>
    <input id="name" placeholder="Name" />
    <input id="amount" placeholder="Amount" />
    <input id="category" placeholder="Category" />
    <button onclick="addData()">Add</button>
</body>
</html>
